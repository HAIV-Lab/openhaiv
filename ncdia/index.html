
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../overview/">
      
      
        <link rel="next" href="../config/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>🧩 NCDIA - OpenHAIV</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ncdia" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="OpenHAIV" class="md-header__button md-logo" aria-label="OpenHAIV" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OpenHAIV
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              🧩 NCDIA
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="cyan"  aria-label="切换至夜间模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="切换至夜间模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="cyan"  aria-label="切换至日间模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换至日间模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/HAIV-Lab/openhaiv" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    OpenHAIV
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="OpenHAIV" class="md-nav__button md-logo" aria-label="OpenHAIV" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    OpenHAIV
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/HAIV-Lab/openhaiv" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    OpenHAIV
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://arxiv.org/abs/2508.07270" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📄 Paper Link
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ✨ Get Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            ✨ Get Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    👋 Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quik/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🚀 Quik Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../methods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📚 Supported Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../results/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📊 Results
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    📖 Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            📖 Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    👀 Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    🧩 NCDIA
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    🧩 NCDIA
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ncdiaalgorithms" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ncdiaalgorithmsbasepy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms.base.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.algorithms.base.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basealg" class="md-nav__link">
    <span class="md-ellipsis">
      BaseAlg
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiaalgorithmsincremental" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms.incremental
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiaalgorithmsncdautoncdpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms.ncd.autoncd.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.algorithms.ncd.autoncd.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#autoncd" class="md-nav__link">
    <span class="md-ellipsis">
      AutoNCD
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiaalgorithmsoodautooodpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms.ood.autoood.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.algorithms.ood.autoood.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#autoood" class="md-nav__link">
    <span class="md-ellipsis">
      AutoOOD
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiaalgorithmsoodmethodspy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms.ood.methods.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiaalgorithmsoodinferencepy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms.ood.inference.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiaalgorithmsoodmetricspy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms.ood.metrics.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiaalgorithmssupervisedstandardpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms.supervised.standard.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.algorithms.supervised.standard.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#standardsl" class="md-nav__link">
    <span class="md-ellipsis">
      StandardSL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ncdiadataloader" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.dataloader
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.dataloader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ncdiadataloaderbasepy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.dataloader.base.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiadataloadertoolspy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.dataloader.tools.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiadataloaderdatasets" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.dataloader.datasets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiadataloaderaugmentations" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.dataloader.augmentations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ncdiamodel" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ncdiamodelsmodelspy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.models.models.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiamodelsnetinc_netpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.models.net.inc_net.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.models.net.inc_net.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basenet" class="md-nav__link">
    <span class="md-ellipsis">
      BaseNet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incrementalnet" class="md-nav__link">
    <span class="md-ellipsis">
      IncrementalNet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ncdiatrainers" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.trainers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ncdiatrainersbasepy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers.base.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.trainers.base.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basetrainer" class="md-nav__link">
    <span class="md-ellipsis">
      BaseTrainer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiatrainerspretrainerpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers.pretrainer.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.trainers.pretrainer.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pretrainer" class="md-nav__link">
    <span class="md-ellipsis">
      PreTrainer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiatrainersinctrainerpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers.inctrainer.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.trainers.inctrainer.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inctrainer" class="md-nav__link">
    <span class="md-ellipsis">
      IncTrainer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiatrainershooks" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers.hooks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.trainers.hooks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hook" class="md-nav__link">
    <span class="md-ellipsis">
      Hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alghook" class="md-nav__link">
    <span class="md-ellipsis">
      AlgHook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loggerhook" class="md-nav__link">
    <span class="md-ellipsis">
      LoggerHook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrichook" class="md-nav__link">
    <span class="md-ellipsis">
      MetricHook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modelhook" class="md-nav__link">
    <span class="md-ellipsis">
      ModelHook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdhook" class="md-nav__link">
    <span class="md-ellipsis">
      NCDHook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimizerhook" class="md-nav__link">
    <span class="md-ellipsis">
      OptimizerHook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schedulerhook" class="md-nav__link">
    <span class="md-ellipsis">
      SchedulerHook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiatrainersoptims" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers.optims
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.trainers.optims">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ncdiatrainersoptimsoptimizerpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers.optims.optimizer.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiatrainersoptimsschedulerpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers.optims.scheduler.py
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiatrainerspriority" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers.priority
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.trainers.priority">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#priority" class="md-nav__link">
    <span class="md-ellipsis">
      Priority
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ncdiautils" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ncdiautilsmetrics" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils.metrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.utils.metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ncdiautilsmetricsaccuracypy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils.metrics.accuracy.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiautilsmetricsmeterpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils.metrics.meter.py
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiautilslosses" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils.losses
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.utils.losses">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crossentropyloss" class="md-nav__link">
    <span class="md-ellipsis">
      CrossEntropyLoss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#angularpenaltysmloss" class="md-nav__link">
    <span class="md-ellipsis">
      AngularPenaltySMLoss
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiautilscfgpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils.cfg.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.utils.cfg.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configs" class="md-nav__link">
    <span class="md-ellipsis">
      Configs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiautilsloggerpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils.logger.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiautilsregistrypy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils.registry.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.utils.registry.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#registry" class="md-nav__link">
    <span class="md-ellipsis">
      Registry
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiautilstoolspy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils.tools.py
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ⚙️ Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scripts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📜 Scripts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ℹ️ About
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            ℹ️ About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../people/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🧑‍🤝‍🧑 People
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🛠️ Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../citation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📖 Citation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../acknowledgment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🙏 Acknowledgment
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ncdiaalgorithms" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ncdiaalgorithmsbasepy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms.base.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.algorithms.base.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basealg" class="md-nav__link">
    <span class="md-ellipsis">
      BaseAlg
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiaalgorithmsincremental" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms.incremental
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiaalgorithmsncdautoncdpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms.ncd.autoncd.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.algorithms.ncd.autoncd.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#autoncd" class="md-nav__link">
    <span class="md-ellipsis">
      AutoNCD
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiaalgorithmsoodautooodpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms.ood.autoood.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.algorithms.ood.autoood.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#autoood" class="md-nav__link">
    <span class="md-ellipsis">
      AutoOOD
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiaalgorithmsoodmethodspy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms.ood.methods.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiaalgorithmsoodinferencepy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms.ood.inference.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiaalgorithmsoodmetricspy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms.ood.metrics.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiaalgorithmssupervisedstandardpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.algorithms.supervised.standard.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.algorithms.supervised.standard.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#standardsl" class="md-nav__link">
    <span class="md-ellipsis">
      StandardSL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ncdiadataloader" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.dataloader
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.dataloader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ncdiadataloaderbasepy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.dataloader.base.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiadataloadertoolspy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.dataloader.tools.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiadataloaderdatasets" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.dataloader.datasets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiadataloaderaugmentations" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.dataloader.augmentations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ncdiamodel" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ncdiamodelsmodelspy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.models.models.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiamodelsnetinc_netpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.models.net.inc_net.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.models.net.inc_net.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basenet" class="md-nav__link">
    <span class="md-ellipsis">
      BaseNet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incrementalnet" class="md-nav__link">
    <span class="md-ellipsis">
      IncrementalNet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ncdiatrainers" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.trainers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ncdiatrainersbasepy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers.base.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.trainers.base.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basetrainer" class="md-nav__link">
    <span class="md-ellipsis">
      BaseTrainer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiatrainerspretrainerpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers.pretrainer.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.trainers.pretrainer.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pretrainer" class="md-nav__link">
    <span class="md-ellipsis">
      PreTrainer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiatrainersinctrainerpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers.inctrainer.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.trainers.inctrainer.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inctrainer" class="md-nav__link">
    <span class="md-ellipsis">
      IncTrainer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiatrainershooks" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers.hooks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.trainers.hooks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hook" class="md-nav__link">
    <span class="md-ellipsis">
      Hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alghook" class="md-nav__link">
    <span class="md-ellipsis">
      AlgHook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loggerhook" class="md-nav__link">
    <span class="md-ellipsis">
      LoggerHook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrichook" class="md-nav__link">
    <span class="md-ellipsis">
      MetricHook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modelhook" class="md-nav__link">
    <span class="md-ellipsis">
      ModelHook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdhook" class="md-nav__link">
    <span class="md-ellipsis">
      NCDHook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimizerhook" class="md-nav__link">
    <span class="md-ellipsis">
      OptimizerHook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schedulerhook" class="md-nav__link">
    <span class="md-ellipsis">
      SchedulerHook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiatrainersoptims" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers.optims
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.trainers.optims">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ncdiatrainersoptimsoptimizerpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers.optims.optimizer.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiatrainersoptimsschedulerpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers.optims.scheduler.py
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiatrainerspriority" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.trainers.priority
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.trainers.priority">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#priority" class="md-nav__link">
    <span class="md-ellipsis">
      Priority
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ncdiautils" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ncdiautilsmetrics" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils.metrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.utils.metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ncdiautilsmetricsaccuracypy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils.metrics.accuracy.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiautilsmetricsmeterpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils.metrics.meter.py
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiautilslosses" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils.losses
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.utils.losses">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crossentropyloss" class="md-nav__link">
    <span class="md-ellipsis">
      CrossEntropyLoss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#angularpenaltysmloss" class="md-nav__link">
    <span class="md-ellipsis">
      AngularPenaltySMLoss
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiautilscfgpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils.cfg.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.utils.cfg.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configs" class="md-nav__link">
    <span class="md-ellipsis">
      Configs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiautilsloggerpy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils.logger.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiautilsregistrypy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils.registry.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncdia.utils.registry.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#registry" class="md-nav__link">
    <span class="md-ellipsis">
      Registry
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncdiautilstoolspy" class="md-nav__link">
    <span class="md-ellipsis">
      ncdia.utils.tools.py
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="ncdia">ncdia<a class="headerlink" href="#ncdia" title="Permanent link">&para;</a></h1>
<h2 id="ncdiaalgorithms">ncdia.algorithms<a class="headerlink" href="#ncdiaalgorithms" title="Permanent link">&para;</a></h2>
<p>NCDIA stands for Novel-Category Discovery and Incremental Adaptation, which includes incremental learning algorithms, novel class discovery algorithms, and out-of-distribution detection algorithms, as well as supervised learning algorithms.</p>
<h3 id="ncdiaalgorithmsbasepy">ncdia.algorithms.base.py<a class="headerlink" href="#ncdiaalgorithmsbasepy" title="Permanent link">&para;</a></h3>
<h4 id="basealg">BaseAlg<a class="headerlink" href="#basealg" title="Permanent link">&para;</a></h4>
<p>Basic algorithm class to define the interface of an algorithm.</p>
<ul>
<li>
<p><span class="highlight-text"><strong>__init__(self, trainer)</strong></span></p>
<p>The constructor method that initializes an instance of <strong>BaseAlg</strong>.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>trainer</strong> (<em>object</em>): Trainer object.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>train_step(self, trainer, data, label, *args, </strong>kwargs)**</span></p>
<p>Training step.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>trainer</strong> (<em>object</em>): Trainer object.</li>
<li><strong>data</strong> (<em>torch.Tensor</em>): Input data.</li>
<li><strong>label</strong> (<em>torch.Tensor</em>): Label data.</li>
<li><strong>args</strong> (<em>tuple</em>): Additional arguments.</li>
<li><strong>kwargs</strong> (<em>dict</em>): Additional keyword arguments.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>results</strong> (<em>dict</em>): Training results. Contains the following keys:<ul>
<li><strong>"loss"</strong>: Loss value.</li>
<li><strong>"acc"</strong>: Accuracy value.</li>
<li><strong>other</strong> "key:value" pairs.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>val_step(self, trainer, data, label, *args, </strong>kwargs)**</span></p>
<p>Validation step.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>trainer</strong> (<em>object</em>): Trainer object.</li>
<li><strong>data</strong> (<em>torch.Tensor</em>): Input data.</li>
<li><strong>label</strong> (<em>torch.Tensor</em>): Label data.</li>
<li><strong>args</strong> (<em>tuple</em>): Additional arguments.</li>
<li><strong>kwargs</strong> (<em>dict</em>): Additional keyword arguments.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>results</strong> (<em>dict</em>): Validation results. Contains the following keys:<ul>
<li><strong>"loss"</strong>: Loss value.</li>
<li><strong>"acc"</strong>: Accuracy value.</li>
<li><strong>other</strong> "key:value" pairs.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>test_step(self, trainer, data, label, *args, </strong>kwargs)**</span></p>
<p>Test step.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>trainer</strong> (<em>object</em>): Trainer object.</li>
<li><strong>data</strong> (<em>torch.Tensor</em>): Input data.</li>
<li><strong>label</strong> (<em>torch.Tensor</em>): Label data.</li>
<li><strong>args</strong> (<em>tuple</em>): Additional arguments.</li>
<li><strong>kwargs</strong> (<em>dict</em>): Additional keyword arguments.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>results</strong> (<em>dict</em>): Test results. Contains the following keys:<ul>
<li><strong>"loss"</strong>: Loss value.</li>
<li><strong>"acc"</strong>: Accuracy value.</li>
<li><strong>other</strong> "key:value" pairs.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="ncdiaalgorithmsincremental">ncdia.algorithms.incremental<a class="headerlink" href="#ncdiaalgorithmsincremental" title="Permanent link">&para;</a></h3>
<p>Include implementation of Class Incremental Learning (CIL) and Few-shot Class Incremental Learning (FSCIL) algorithm.</p>
<ul>
<li><strong>CIL</strong><ul>
<li><strong>Finetune</strong></li>
<li><strong>LwF</strong></li>
<li><strong>EwC</strong></li>
<li><strong>iCarL</strong></li>
<li><strong>IL2A</strong></li>
<li><strong>WA</strong>    </li>
</ul>
</li>
<li><strong>FSCIL</strong><ul>
<li><strong>ALICE</strong></li>
<li><strong>FACT</strong></li>
<li><strong>SAVC</strong></li>
</ul>
</li>
</ul>
<h3 id="ncdiaalgorithmsncdautoncdpy">ncdia.algorithms.ncd.autoncd.py<a class="headerlink" href="#ncdiaalgorithmsncdautoncdpy" title="Permanent link">&para;</a></h3>
<p>Modules related to novel class discovery.</p>
<h4 id="autoncd">AutoNCD<a class="headerlink" href="#autoncd" title="Permanent link">&para;</a></h4>
<p>Class for evaluating with OOD metrics and relabeling the OOD dataset for the next session.</p>
<ul>
<li>
<p><span class="highlight-text"><strong>__init__(self, model, train_loader, test_loader, device=None, verbose=False)</strong></span></p>
<p>The constructor method that initializes an instance of <strong>AutoNCD</strong>. </p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>model</strong> (<em>nn.Module</em>): model to be evaluated.</li>
<li><strong>train_loader</strong> (<em>DataLoader</em>): train dataloader.</li>
<li><strong>test_loader</strong> (<em>DataLoader</em>): test dataloader.</li>
<li><strong>device</strong> (<em>torch.device, optional</em>): device to run the evaluation. Default to None.</li>
<li><strong>verbose</strong> (<em>bool, optional</em>): print the progress bar. Default to False. </li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>inference(self, dataloader, split='train')</strong></span></p>
<p>Inference the model on the dataloader and return relevant information. If split is 'train', return the prototype of the training data. </p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>dataloader</strong> (<em>DataLoader</em>): dataloader for evaluation.</li>
<li><strong>split</strong> (<em>str, optional</em>): train or test. Defaults to 'train'.</li>
</ul>
<p><strong>Returns:</strong></p>
<p>If split is 'train':</p>
<ul>
<li>
<p><strong>features</strong> (<em>torch.Tensor</em>): feature vectors, (N, D).</p>
</li>
<li>
<p><strong>logits</strong> (<em>torch.Tensor</em>): logit vectors, (N, C).</p>
</li>
<li>
<p><strong>prototype_cls</strong> (<em>torch.Tensor</em>): prototype vectors, (C, D).</p>
</li>
</ul>
<p>If split is 'test':</p>
<ul>
<li>
<p><strong>imgpaths</strong> (<em>list</em>): image paths (list).</p>
</li>
<li>
<p><strong>features</strong> (<em>torch.Tensor</em>): feature vectors, (N, D).</p>
</li>
<li>
<p><strong>logits</strong> (<em>torch.Tensor</em>): logit vectors, (N, C).</p>
</li>
<li>
<p><strong>preds</strong> (<em>torch.Tensor</em>): prediction labels, (N,).</p>
</li>
<li>
<p><strong>labels</strong> (<em>torch.Tensor</em>): ground truth labels, (N,).</p>
</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>relabel(self, ood_loader, metrics=[], tpr_th=0.95, prec_th=None)</strong></span></p>
<p>Relabel the OOD dataset for the next session.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>ood_loader</strong> (<em>DataLoader</em>): OOD dataloader for relabeling.</li>
<li><strong>metrics</strong> (<em>list, optional</em>): metrics to evaluate the OOD dataset. Defaults to [].</li>
<li><strong>tpr_th</strong> (<em>float, optional</em>): True positive rate threshold. Defaults to 0.95.</li>
<li><strong>prec_th</strong> (<em>float, optional</em>): Precision threshold. Defaults to None.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>ood_loader</strong> (<em>DataLoader</em>): relabeled OOD dataloader.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>_split_cluster_label(self, y_label, y_pred, ood_class)</strong></span></p>
<p>Calculate clustering accuracy. Require scikit-learn installed. First compute linear assignment on all data, then look at how good the accuracy is on subsets.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>y_label</strong> (<em>numpy.array</em>): true labels, (n_samples,)</li>
<li><strong>y_pred</strong> (<em>numpy.array</em>): predicted labels (n_samples,)</li>
<li><strong>ood_class</strong>: out-of-distribution class labels</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>cluster_label</strong>: cluster label</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>search_discrete_point(self, novel_feat, novel_target)</strong></span></p>
</li>
</ul>
<p><span style="color: red;"><strong>TODO</strong></span></p>
<h3 id="ncdiaalgorithmsoodautooodpy">ncdia.algorithms.ood.autoood.py<a class="headerlink" href="#ncdiaalgorithmsoodautooodpy" title="Permanent link">&para;</a></h3>
<h4 id="autoood">AutoOOD<a class="headerlink" href="#autoood" title="Permanent link">&para;</a></h4>
<p>Class for evaluating OOD detection methods.</p>
<ul>
<li>
<p><span class="highlight-text"><strong>eval(prototype_cls, fc_weight, train_feats, train_logits, id_feats, id_logits, id_labels, ood_feats, ood_logits, ood_labels, metrics=[], tpr_th=0.95, prec_th=None, id_attrs=None, ood_attrs=None, prototype_att=None)</strong></span></p>
<p>Evaluate the OOD detection methods and return OOD scores.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>prototype_cls</strong> (<em>np.ndarray</em>): prototype of training data</li>
<li><strong>fc_weight</strong> (<em>np.ndarray</em>): weight of the last layer</li>
<li><strong>train_feats</strong> (<em>np.ndarray</em>): feature of training data</li>
<li><strong>train_logits</strong> (<em>np.ndarray</em>): logits of training data</li>
<li><strong>id_feats</strong> (<em>np.ndarray</em>): feature of ID data</li>
<li><strong>id_logits</strong> (<em>np.ndarray</em>): logits of ID data</li>
<li><strong>id_labels</strong> (<em>np.ndarray</em>): labels of ID data</li>
<li><strong>ood_feats</strong> (<em>np.ndarray</em>): feature of OOD data</li>
<li><strong>ood_logits</strong> (<em>np.ndarray</em>): logits of OOD data</li>
<li><strong>ood_labels</strong> (<em>np.ndarray</em>): labels of OOD data</li>
<li><strong>metrics</strong> (<em>list, optional</em>): list of OOD detection methods to evaluate. Defaults to [].</li>
<li><strong>tpr_th</strong> (<em>float, optional</em>): True positive rate threshold. Defaults to 0.95.</li>
<li><strong>prec_th</strong> (<em>float, optional</em>): Precision threshold. Defaults to None.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>ood_scores</strong> (<em>dict</em>): OOD scores, keys are the names of the OOD detection methods, values are the OOD scores and search threshold. Each value is a tuple containing the following:<ul>
<li><strong>ood metrics</strong> (<em>tuple</em>):<ul>
<li><strong>fpr</strong> (<em>float</em>): false positive rate</li>
<li><strong>auroc</strong> (<em>float</em>): area under the ROC curve</li>
<li><strong>aupr_in</strong> (<em>float</em>): area under the precision-recall curve for in-distribution samples</li>
<li><strong>aupr_out</strong> (<em>float</em>): area under the precision-recall curve for out-of-distribution samples</li>
</ul>
</li>
<li><strong>search threshold</strong> (<em>tuple</em>): threshold for OOD detection if prec_th is not None<ul>
<li><strong>best_th</strong> (<em>float</em>): best threshold for OOD detection</li>
<li><strong>conf</strong> (<em>torch.Tensor</em>): confidence scores</li>
<li><strong>label</strong> (<em>torch.Tensor</em>): label array</li>
<li><strong>precisions</strong> (<em>float</em>): precision when precisions &gt;= prec_th</li>
<li><strong>recalls</strong> (<em>float</em>): recall when precisions &gt;= prec_th</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>inference(metrics, logits, feat, train_logits, train_feat, fc_weight, prototype, logits_att=None, prototype_att=None)</strong></span></p>
<p>Inferencec method for OOD detection</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>metrics</strong> (<em>list</em>): the ood metrics used for inference.</li>
<li><strong>logits</strong> (<em>np.ndarray</em>): logits of inference data.</li>
<li><strong>feat</strong> (<em>np.ndarray</em>): features of inference data.</li>
<li><strong>train_logits</strong> (<em>np.ndarray</em>): logits of training data.</li>
<li><strong>train_feat</strong> (<em>np.ndarray</em>): features of training data.</li>
<li><strong>fc_weight</strong> (<em>np.ndarray</em>): weight of the last layer.</li>
<li><strong>prototype</strong> (<em>np.ndarray</em>): prototypes of training data.</li>
<li><strong>logits_att</strong> (<em>np.ndarray, optional</em>): logits of attribute.</li>
<li><strong>prototype_att</strong> (<em>np.ndarray, optional</em>): prototypes of attribute. </li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>conf</strong> (<em>dict</em>): contains the confidence using different metrics, <strong>conf[metric]</strong> (<em>torch.Tensor</em>) is the confidence using specific metric.</li>
</ul>
</li>
</ul>
<h3 id="ncdiaalgorithmsoodmethodspy">ncdia.algorithms.ood.methods.py<a class="headerlink" href="#ncdiaalgorithmsoodmethodspy" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><span class="highlight-text"><strong>msp(id_gt, id_logits, ood_gt, ood_logits, tpr_th=0.95, prec_th=None)</strong></span></p>
<p>Maximum Softmax Probability (MSP) method for OOD detection.</p>
<p>A Baseline for Detecting Misclassified and Out-of-Distribution Examples in Neural Networks.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>id_gt</strong> (<em>torch.Tensor</em>): ID ground truth labels. Shape (N,).</li>
<li><strong>id_logits</strong> (<em>torch.Tensor</em>): ID logits. Shape (N, C).</li>
<li><strong>ood_gt</strong> (<em>torch.Tensor</em>): OOD ground truth labels. Shape (M,).</li>
<li><strong>ood_logits</strong> (<em>torch.Tensor</em>): OOD logits. Shape (M, C).</li>
<li><strong>tpr_th</strong> (<em>float</em>): True positive rate threshold to compute
    false positive rate. Default is 0.95.</li>
<li><strong>prec_th</strong> (<em>float</em>): Precision threshold for searching - threshold.
    If None, not searching for threshold. Default is None.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>conf</strong> (<em>np.ndarray</em>): Confidence scores. Shape (N + M,).</li>
<li><strong>label</strong> (<em>np.ndarray</em>): Label array. Shape (N + M,).</li>
<li><strong>fpr</strong> (<em>float</em>): False positive rate.</li>
<li><strong>auroc</strong> (<em>float</em>): Area under the ROC curve.</li>
<li><strong>aupr_in</strong> (<em>float</em>): Area under the precision-recall curve 
    for in-distribution samples.</li>
<li><strong>aupr_out</strong> (<em>float</em>): Area under the precision-recall curve
    for out-of-distribution</li>
<li><strong>best_th</strong> (<em>float</em>): Threshold for OOD detection. If prec_th is None, None.</li>
<li><strong>prec</strong> (<em>float</em>): Precision at the threshold. If prec_th is None, None.</li>
<li><strong>recall</strong> (<em>float</em>): Recall at the threshold. If prec_th is None, None.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>mcm(id_gt, id_logits, ood_gt, ood_logits, T=2, tpr_th=0.95, prec_th=None)</strong></span></p>
<p>Maximum Concept Matching (MCM) method for OOD detection.</p>
<p>Delving into Out-of-Distribution Detection with Vision-Language Representations</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>id_gt</strong> (<em>torch.Tensor</em>): ID ground truth labels. Shape (N,).</li>
<li><strong>id_logits</strong> (<em>torch.Tensor</em>): ID logits. Shape (N, C).</li>
<li><strong>ood_gt</strong> (<em>torch.Tensor</em>): OOD ground truth labels. Shape (M,).</li>
<li><strong>ood_logits</strong> (<em>torch.Tensor</em>): OOD logits. Shape (M, C).</li>
<li><strong>T</strong> (<em>int</em>): Temperature for softmax.</li>
<li><strong>tpr_th</strong> (<em>float</em>): True positive rate threshold to compute
    false positive rate. Default is 0.95.</li>
<li><strong>prec_th</strong> (<em>float</em>): Precision threshold for searching threshold.
    If None, not searching for threshold. Default is None.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>fpr</strong> (<em>float</em>): False positive rate.</li>
<li><strong>auroc</strong> (<em>float</em>): Area under the ROC curve.</li>
<li><strong>aupr_in</strong> (<em>float</em>): Area under the precision-recall curve 
    for in-distribution samples.</li>
<li><strong>aupr_out</strong> (<em>float</em>): Area under the precision-recall curve
    for out-of-distribution.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>max_logit(id_gt, id_logits, ood_gt, ood_logits, tpr_th=0.95, prec_th=None)</strong></span></p>
<p>Maximum Logit (MaxLogit) method for OOD detection.</p>
<p>Scaling Out-of-Distribution Detection for Real-World Settings</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>id_gt</strong> (<em>torch.Tensor</em>): ID ground truth labels. Shape (N,).</li>
<li><strong>id_logits</strong> (<em>torch.Tensor</em>): ID logits. Shape (N, C).</li>
<li><strong>ood_gt</strong> (<em>torch.Tensor</em>): OOD ground truth labels. Shape (M,).</li>
<li><strong>ood_logits</strong> (<em>torch.Tensor</em>): OOD logits. Shape (M, C).</li>
<li><strong>tpr_th</strong> (<em>float</em>): True positive rate threshold to compute
    false positive rate. Default is 0.95.</li>
<li><strong>prec_th</strong> (<em>float</em>): Precision threshold for searching threshold.
    If None, not searching for threshold. Default is None.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>fpr</strong> (<em>float</em>): False positive rate.</li>
<li><strong>auroc</strong> (<em>float</em>): Area under the ROC curve.</li>
<li><strong>aupr_in</strong> (<em>float</em>): Area under the precision-recall curve 
    for in-distribution samples.</li>
<li><strong>aupr_out</strong> (<em>float</em>): Area under the precision-recall curve
    for out-of-distribution</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>energy(id_gt, id_logits, ood_gt, ood_logits, tpr_th=0.95, prec_th=None)</strong></span></p>
<p>Energy-based method for OOD detection.</p>
<p>Energy-based Out-of-distribution Detection</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>id_gt</strong> (<em>torch.Tensor</em>): ID ground truth labels. Shape (N,).</li>
<li><strong>id_logits</strong> (<em>torch.Tensor</em>): ID logits. Shape (N, C).</li>
<li><strong>ood_gt</strong> (<em>torch.Tensor</em>): OOD ground truth labels. Shape (M,).</li>
<li><strong>ood_logits</strong> (<em>torch.Tensor</em>): OOD logits. Shape (M, C).</li>
<li><strong>tpr_th</strong> (<em>float</em>): True positive rate threshold to compute
    false positive rate. Default is 0.95.</li>
<li><strong>prec_th</strong> (<em>float</em>): Precision threshold for searching threshold.
    If None, not searching for threshold. Default is None.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>fpr</strong> (<em>float</em>): False positive rate.</li>
<li><strong>auroc</strong> (<em>float</em>): Area under the ROC curve.</li>
<li><strong>aupr_in</strong> (<em>float</em>): Area under the precision-recall curve 
    for in-distribution samples.</li>
<li><strong>aupr_out</strong> (<em>float</em>): Area under the precision-recall curve
    for out-of-distribution</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>vim(id_gt, id_logits, id_feat, ood_gt, ood_logits, ood_feat, train_logits, train_feat, tpr_th=0.95, prec_th=None)</strong></span></p>
<p>Virtual-Logit Matching (ViM) method for OOD detection.</p>
<p>ViM: Out-of-Distribution With Virtual-Logit Matching</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>id_gt</strong> (<em>torch.Tensor</em>): ID ground truth labels. Shape (N,).</li>
<li><strong>id_logits</strong> (<em>torch.Tensor</em>): ID logits. Shape (N, C).</li>
<li><strong>id_feat</strong> (<em>torch.Tensor</em>): ID features. Shape (N, D).</li>
<li><strong>ood_gt</strong> (<em>torch.Tensor</em>): OOD ground truth labels. Shape (M,).</li>
<li><strong>ood_logits</strong> (<em>torch.Tensor</em>): OOD logits. Shape (M, C).</li>
<li><strong>ood_feat</strong> (<em>torch.Tensor</em>): OOD features. Shape (M, D).</li>
<li><strong>train_logits</strong> (<em>torch.Tensor</em>): Training logits. Shape (K, C).</li>
<li><strong>train_feat</strong> (<em>torch.Tensor</em>): Training features. Shape (K, D).</li>
<li><strong>tpr_th</strong> (<em>float</em>): True positive rate threshold to compute
    false positive rate. Default is 0.95.</li>
<li><strong>prec_th</strong> (<em>float</em>): Precision threshold for searching threshold.
    If None, not searching for threshold. Default is None.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>fpr</strong> (<em>float</em>): False positive rate.</li>
<li><strong>auroc</strong> (<em>float</em>): Area under the ROC curve.</li>
<li><strong>aupr_in</strong> (<em>float</em>): Area under the precision-recall curve 
    for in-distribution samples.</li>
<li><strong>aupr_out</strong> (<em>float</em>): Area under the precision-recall curve
    for out-of-distribution</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>dml(id_gt, id_feat, ood_gt, ood_feat, fc_weight, tpr_th=0.95, prec_th=None)</strong></span></p>
<p>Decoupled MaxLogit (DML) method for OOD detection.</p>
<p>Decoupling MaxLogit for Out-of-Distribution Detection</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>id_gt</strong> (<em>torch.Tensor</em>): ID ground truth labels. Shape (N,).</li>
<li><strong>id_feat</strong> (<em>torch.Tensor</em>): ID features. Shape (N, D).</li>
<li><strong>ood_gt</strong> (<em>torch.Tensor</em>): OOD ground truth labels. Shape (M,).</li>
<li><strong>ood_feat</strong> (<em>torch.Tensor</em>): OOD features. Shape (M, D).</li>
<li><strong>fc_weight</strong> (<em>torch.Tensor</em>): FC layer weight. Shape (C, D).</li>
<li><strong>tpr_th</strong> (<em>float</em>): True positive rate threshold to compute
    false positive rate. Default is 0.95.</li>
<li><strong>prec_th</strong> (<em>float</em>): Precision threshold for searching threshold.
    If None, not searching for threshold. Default is None.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>fpr</strong> (<em>float</em>): False positive rate.</li>
<li><strong>auroc</strong> (<em>float</em>): Area under the ROC curve.</li>
<li><strong>aupr_in</strong> (<em>float</em>): Area under the precision-recall curve 
    for in-distribution samples.</li>
<li><strong>aupr_out</strong> (<em>float</em>): Area under the precision-recall curve
    for out-of-distribution</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>dmlp(id_gt, id_logits, id_feat, ood_gt, ood_logits, ood_feat, fc_weight, prototype,tpr_th=0.95, prec_th=None)</strong></span></p>
<p>Decoupled MaxLogit+ (DML+) method for OOD detection.</p>
<p>Decoupling MaxLogit for Out-of-Distribution Detection</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>id_gt</strong> (<em>torch.Tensor</em>): ID ground truth labels. Shape (N,).</li>
<li><strong>id_logits</strong> (<em>torch.Tensor</em>): ID logits. Shape (N, C).</li>
<li><strong>id_feat</strong> (<em>torch.Tensor</em>): ID features. Shape (N, D).</li>
<li><strong>ood_gt</strong> (<em>torch.Tensor</em>): OOD ground truth labels. Shape (M,).</li>
<li><strong>ood_logits</strong> (<em>torch.Tensor</em>): OOD logits. Shape (M, C).</li>
<li><strong>ood_feat</strong> (<em>torch.Tensor</em>): OOD features. Shape (M, D).</li>
<li><strong>fc_weight</strong> (<em>torch.Tensor</em>): FC layer weight. Shape (D, C).</li>
<li><strong>prototype</strong> (<em>torch.Tensor</em>): Prototype. Shape (D, C).</li>
<li><strong>tpr_th</strong> (<em>float</em>): True positive rate threshold to compute
    false positive rate. Default is 0.95.</li>
<li><strong>prec_th</strong> (<em>float</em>): Precision threshold for searching threshold.
    If None, not searching for threshold. Default is None.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>fpr</strong> (<em>float</em>): False positive rate.</li>
<li><strong>auroc</strong> (<em>float</em>): Area under the ROC curve.</li>
<li><strong>aupr_in</strong> (<em>float</em>): Area under the precision-recall curve 
    for in-distribution samples.</li>
<li><strong>aupr_out</strong> (<em>float</em>): Area under the precision-recall curve
    for out-of-distribution</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>prot(id_gt, id_logits, ood_gt, ood_logits, prototypes: list, tpr_th=0.95, prec_th=None)</strong></span></p>
<p>Prototype-based (Prot) method for OOD detection.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>id_gt</strong> (<em>torch.Tensor</em>): ID ground truth labels, shape (N,).</li>
<li><strong>id_logits</strong> (<em>list of torch.Tensor</em>): ID logits, containing shape (N, C).</li>
<li><strong>ood_gt</strong> (<em>torch.Tensor</em>): OOD ground truth labels, shape (M,).</li>
<li><strong>ood_logits</strong> (<em>list of torch.Tensor</em>): OOD logits, containing shape (M, C).</li>
<li><strong>prototypes</strong> (<em>list of torch.Tensor</em>): Prototypes, containing shape (D, C).</li>
<li><strong>tpr_th</strong> (<em>float</em>): True positive rate threshold to compute 
    false positive rate.</li>
<li><strong>prec_th</strong> (<em>float</em>): Precision threshold for searching threshold.
    If None, not searching for threshold. Default is</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>fpr</strong> (<em>float</em>): False positive rate.</li>
<li><strong>auroc</strong> (<em>float</em>): Area under the ROC curve.</li>
<li><strong>aupr_in</strong> (<em>float</em>): Area under the precision-recall curve 
    for in-distribution samples.</li>
<li><strong>aupr_out</strong> (<em>float</em>): Area under the precision-recall curve
    for out-of-distribution</li>
</ul>
</li>
</ul>
<h3 id="ncdiaalgorithmsoodinferencepy">ncdia.algorithms.ood.inference.py<a class="headerlink" href="#ncdiaalgorithmsoodinferencepy" title="Permanent link">&para;</a></h3>
<p>The inference version of implemented ood methods in <a href="#ncdiaalgorithmsoodmethodspy">ncdia.algorithms.ood.methods.py</a></p>
<h3 id="ncdiaalgorithmsoodmetricspy">ncdia.algorithms.ood.metrics.py<a class="headerlink" href="#ncdiaalgorithmsoodmetricspy" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><span class="highlight-text"><strong>ood_metrics(conf, label, tpr_th=0.95)</strong></span></p>
<p>Compute OOD metrics.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>conf</strong> (<em>np.ndarray</em>): Confidence scores. Shape (N,).</li>
<li><strong>label</strong> (<em>np.ndarray</em>): Label array. Shape (N,). Containing:
    -1: OOD samples.
    int &gt;= 0: ID samples with class labels</li>
<li><strong>tpr_th</strong> (<em>float</em>): True positive rate threshold to compute 
    false positive rate.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>fpr</strong> (<em>float</em>): False positive rate.</li>
<li><strong>auroc</strong> (<em>float</em>): Area under the ROC curve.</li>
<li><strong>aupr_in</strong> (<em>float</em>): Area under the precision-recall curve 
    for in-distribution samples.</li>
<li><strong>aupr_out</strong> (<em>float</em>): Area under the precision-recall curve
    for out-of-distribution samples.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>search_threshold(conf, label, prec_th)</strong></span></p>
<p>Search for the threshold for OOD detection.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>conf</strong> (<em>np.ndarray</em>): Confidence scores. Shape (N,).</li>
<li><strong>label</strong> (<em>np.ndarray</em>): Label array. Shape (N,). Containing:
    -1: OOD samples.
    int &gt;= 0: ID samples with class labels</li>
<li><strong>prec_th</strong> (<em>float</em>): Precision threshold.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>best_th</strong> (<em>float</em>): Threshold for OOD detection.</li>
<li><strong>prec</strong> (<em>float</em>): Precision at the threshold.</li>
<li><strong>recall</strong> (<em>float</em>): Recall at the threshold.</li>
</ul>
</li>
</ul>
<h3 id="ncdiaalgorithmssupervisedstandardpy">ncdia.algorithms.supervised.standard.py<a class="headerlink" href="#ncdiaalgorithmssupervisedstandardpy" title="Permanent link">&para;</a></h3>
<p>Modules related to supervised learning</p>
<h4 id="standardsl">StandardSL<a class="headerlink" href="#standardsl" title="Permanent link">&para;</a></h4>
<p>Class inherits from <strong>BaseAlg</strong>. Standard supervised learning algorithm</p>
<ul>
<li>
<p><span class="highlight-text"><strong>train_step(self, trainer, data, label, *args, **kwargs)</strong></span></p>
<p>Training step for standard supervised learning.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>trainer</strong> (<em>object</em>): Trainer object.</li>
<li><strong>data</strong> (<em>torch.Tensor</em>): Input data.</li>
<li><strong>label</strong> (<em>torch.Tensor</em>): Label data.</li>
<li><strong>args</strong> (<em>tuple</em>): Additional arguments.</li>
<li><strong>kwargs</strong> (<em>dict</em>): Additional keyword arguments.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>
<p><strong>results</strong> (<em>dict</em>): Training results. Contains the following keys:</p>
<ul>
<li><strong>"loss"</strong>: Loss value.</li>
<li><strong>"acc"</strong>: Accuracy value.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>val_step(self, trainer, data, label, *args, **kwargs)</strong></span></p>
<p>Validation step for standard supervised learning.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>trainer</strong> (<em>object</em>): Trainer object.</li>
<li><strong>data</strong> (<em>torch.Tensor</em>): Input data.</li>
<li><strong>label</strong> (<em>torch.Tensor</em>): Label data.</li>
<li><strong>args</strong> (<em>tuple</em>): Additional arguments.</li>
<li><strong>kwargs</strong> (<em>dict</em>): Additional keyword arguments.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>
<p><strong>results</strong> (<em>dict</em>): Validation results. Contains the following:</p>
<ul>
<li><strong>"loss"</strong>: Loss value.</li>
<li><strong>"acc"</strong>: Accuracy value.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>test_step(self, trainer, data, label, *args, **kwargs)</strong></span></p>
<p>Test step for standard supervised learning.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>trainer (object): Trainer object.</li>
<li>data (torch.Tensor): Input data.</li>
<li>label (torch.Tensor): Label data.</li>
<li>args (tuple): Additional arguments.</li>
<li>kwargs (dict): Additional keyword arguments.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>
<p><strong>results</strong> (<em>dict</em>): Test results. Contains the following:</p>
<ul>
<li><strong>"loss"</strong>: Loss value.</li>
<li><strong>"acc"</strong>: Accuracy value.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="ncdiadataloader">ncdia.dataloader<a class="headerlink" href="#ncdiadataloader" title="Permanent link">&para;</a></h2>
<h3 id="ncdiadataloaderbasepy">ncdia.dataloader.base.py<a class="headerlink" href="#ncdiadataloaderbasepy" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><span class="highlight-text"><strong>build_dataloader(kwargs)</strong></span></p>
<p>Build data loader.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>kwargs</strong> (<em>dict</em>): Arguments for DataLoader. Contains the following:<ul>
<li><strong>dataset</strong> (<em>dict</em>): Dataset configuration.</li>
<li>other arguments for DataLoader, such as <strong>batch_size</strong>, <strong>shuffle</strong>, etc.</li>
</ul>
</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>loader</strong> (<em>DataLoader</em>): Data loader.</li>
</ul>
</li>
</ul>
<h3 id="ncdiadataloadertoolspy">ncdia.dataloader.tools.py<a class="headerlink" href="#ncdiadataloadertoolspy" title="Permanent link">&para;</a></h3>
<p>Implements some of the commonly used dataloaders</p>
<h3 id="ncdiadataloaderdatasets">ncdia.dataloader.datasets<a class="headerlink" href="#ncdiadataloaderdatasets" title="Permanent link">&para;</a></h3>
<p>Implements some of the commonly used datasets, including:</p>
<ul>
<li><strong>CIFAR100</strong></li>
<li><strong>CUB200</strong></li>
<li><strong>Caltech101</strong></li>
<li><strong>Food101</strong></li>
<li><strong>ImageNet</strong></li>
<li><strong>ImageNetR</strong></li>
<li><strong>BM200</strong></li>
</ul>
<h3 id="ncdiadataloaderaugmentations">ncdia.dataloader.augmentations<a class="headerlink" href="#ncdiadataloaderaugmentations" title="Permanent link">&para;</a></h3>
<p>Implements some of the commonly used augmentation methods.</p>
<h2 id="ncdiamodel">ncdia.model<a class="headerlink" href="#ncdiamodel" title="Permanent link">&para;</a></h2>
<h3 id="ncdiamodelsmodelspy">ncdia.models.models.py<a class="headerlink" href="#ncdiamodelsmodelspy" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><span class="highlight-text"><strong>get_network(config)</strong></span></p>
<p>load model.</p>
<p><strong>Parameters:</strong>
-<strong>trainer</strong>(<em>config</em>): model config</p>
</li>
</ul>
<h3 id="ncdiamodelsnetinc_netpy">ncdia.models.net.inc_net.py<a class="headerlink" href="#ncdiamodelsnetinc_netpy" title="Permanent link">&para;</a></h3>
<h4 id="basenet">BaseNet<a class="headerlink" href="#basenet" title="Permanent link">&para;</a></h4>
<p>BaseNet for incremental learning.</p>
<ul>
<li>
<p><span class="highlight-text"><strong>__init__(self, network, base_classes, num_classes, att_classes, net_alice, mode)</strong></span></p>
<p>The constructor method that initializes an instance of <strong>BaseNet</strong>.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>network</strong> (<em>config</em>): The config of the network.</li>
<li><strong>base_classes</strong>(<em>int</em>): The number of base classes.</li>
<li><strong>num_classes</strong>(<em>int</em>): The total class number.</li>
<li><strong>att_classes</strong>(<em>int</em>): The attribute class number.</li>
<li><strong>mode</strong>(<em>str</em>): classifier mode.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>feature_dim(self)</strong></span></p>
<p>The feature dimension of the network.</p>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>out_dim</strong>(<em>int</em>) feature dimension of the network.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>extractor_vector(self, x)</strong></span></p>
<p>get features of input x.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>x</strong>(<em>tensor</em>): input data.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>out_features</strong>(<em>tensor</em>) features of the input.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>forward(self, x)</strong></span></p>
<p>forworad pass of the network.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>x</strong>(<em>tensor</em>): input data.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>results</strong> (<em>dict</em>): forward pass results. Contains the following keys:<ul>
<li><strong>"fmaps"</strong>: [x_1, x_2, ..., x_n],</li>
<li><strong>"features"</strong>: features</li>
<li><strong>"logits"</strong>: logits</li>
</ul>
</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>copy(self)</strong></span></p>
<p>copy.</p>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>copy function</strong>.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>freeze(self)</strong></span></p>
<p>freeze parameters.</p>
</li>
</ul>
<h4 id="incrementalnet">IncrementalNet<a class="headerlink" href="#incrementalnet" title="Permanent link">&para;</a></h4>
<p>Incremental Network which follows BaseNet.</p>
<ul>
<li>
<p><span class="highlight-text"><strong>__init__(self, network, base_classes, num_classes, att_classes, net_alice, mode)</strong></span></p>
<p>The constructor method that initializes an instance of <strong>BaseNet</strong>.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>network</strong> (<em>config</em>): The config of the network.</li>
<li><strong>base_classes</strong>(<em>int</em>): The number of base classes.</li>
<li><strong>num_classes</strong>(<em>int</em>): The total class number.</li>
<li><strong>att_classes</strong>(<em>int</em>): The attribute class number.</li>
<li><strong>mode</strong>(<em>str</em>): classifier mode.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>update_fc(self, nb_classes)</strong></span></p>
<p>update fc parameter, generate new fc and copy old parameter.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>network</strong> (<em>int</em>): New class number.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>fc</strong>: updated fc layers.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>generate_fc(self, in_dim, out_dim)</strong></span></p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>in_dim</strong> (<em>int</em>): new fc in dimension.</li>
<li><strong>out_dim</strong> (<em>int</em>): new fc out dimension.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>fc</strong>: new fc layers.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>forward(self, x)</strong></span></p>
<p>forworad pass of the network.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>x</strong>(<em>tensor</em>): input data.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>results</strong> (<em>dict</em>): forward pass results. Contains the following keys:<ul>
<li><strong>"fmaps"</strong>: [x_1, x_2, ..., x_n],</li>
<li><strong>"features"</strong>: features</li>
<li><strong>"logits"</strong>: logits</li>
</ul>
</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>weight_align(self, increment)</strong></span></p>
<p>normalize classifer parameters.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>increment</strong>(<em>int</em>): incremental classes.</li>
</ul>
</li>
</ul>
<h2 id="ncdiatrainers">ncdia.trainers<a class="headerlink" href="#ncdiatrainers" title="Permanent link">&para;</a></h2>
<h3 id="ncdiatrainersbasepy">ncdia.trainers.base.py<a class="headerlink" href="#ncdiatrainersbasepy" title="Permanent link">&para;</a></h3>
<h4 id="basetrainer">BaseTrainer<a class="headerlink" href="#basetrainer" title="Permanent link">&para;</a></h4>
<p>Basic trainer class for training models.</p>
<p><strong>Attributes:</strong></p>
<ul>
<li><strong>model</strong> (<em>nn.Module</em>): Neural network models.</li>
<li><strong>train_loader</strong> (<em>DataLoader</em>): DataLoader for training.</li>
<li><strong>val_loader</strong> (<em>DataLoader</em>): DataLoader for validation.</li>
<li><strong>test_loader</strong> (<em>DataLoader</em>): DataLoader for testing.</li>
<li><strong>optimizer</strong> (<em>Optimizer</em>): Optimizer.</li>
<li><strong>scheduler</strong> (<em>lr_scheduler._LRScheduler</em>): Learning rate scheduler.</li>
<li><strong>criterion</strong> (<em>Callable</em>): Criterion for training.</li>
<li><strong>algorithm</strong> (<em>object</em>): Algorithm for training.</li>
<li><strong>metrics</strong> (<em>dict</em>): Metrics for evaluation and testing.</li>
<li><strong>session</strong> (<em>int</em>): Session number.</li>
<li><strong>max_epochs</strong> (<em>int</em>): Total epochs for training.</li>
<li><strong>max_train_iters</strong> (<em>int</em>): Iterations on one epoch for training.</li>
<li><strong>max_val_iters</strong> (<em>int</em>): Iterations on one epoch for validation.</li>
<li><strong>max_test_iters</strong> (<em>int</em>): Iterations on one epoch for testing.</li>
<li><strong>epoch</strong> (<em>int</em>): Current training epoch.</li>
<li><strong>iter</strong> (<em>int</em>): Current iteration or index of the current batch.</li>
<li><strong>cfg</strong> (<em>Configs</em>): Configuration for trainer.</li>
<li><strong>hooks</strong> (<em>List[Hook]</em>): List of registered hooks.</li>
<li><strong>logger</strong> (<em>Logger</em>): Logger for logging information.</li>
<li><strong>device</strong> (<em>torch.device</em>): Device to use.</li>
<li><strong>work_dir</strong> (<em>str</em>): Working directory to save logs and checkpoints.</li>
<li><strong>exp_name</strong> (<em>str</em>): Experiment name.</li>
<li><strong>load_from</strong> (<em>str</em>): Checkpoint file path to load.</li>
</ul>
<p><strong>Methods:</strong></p>
<ul>
<li>
<p><span class="highlight-text"><strong> __init__(self, cfg, session, model, train_loader, val_loader, test_loader, default_hooks, custom_hooks, load_from, exp_name, work_dir)</strong></span></p>
<p>The constructor method that initializes an instance of <strong>BaseTrainer</strong>. </p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>cfg</strong> (<em>dict, optional</em>): Configuration for trainer, Contains:<ul>
<li><strong>'trainer'</strong> (<em>dict</em>):<ul>
<li>'type' (<em>str</em>): Type of trainer.</li>
</ul>
</li>
<li><strong>'algorithm'</strong> (<em>dict</em>):<ul>
<li>'type' (<em>str</em>): Type of algorithm.</li>
</ul>
</li>
<li><strong>'criterion'</strong> (<em>dict</em>):<ul>
<li>'type' (<em>str</em>): Type of criterion for training.</li>
</ul>
</li>
<li><strong>'optimizer'</strong>:<ul>
<li>'type' (<em>str</em>): Name of optimizer.</li>
<li>'param_groups' (<em>dict | None</em>): If provided, directly optimize
    param_groups and abandon model.</li>
<li>kwargs (<em>dict</em>) for optimizer, such as 'lr', 'weight_decay', etc.</li>
</ul>
</li>
<li><strong>'scheduler'</strong>:<ul>
<li>'type' (<em>str</em>): Name of scheduler.</li>
<li>kwargs (<em>dict</em>) for scheduler, such as 'step_size', 'gamma', etc.</li>
</ul>
</li>
<li><strong>'device' </strong>(<em>str | torch.device | None</em>): Device to use.
    If None, use 'cuda' if available.</li>
<li><strong>'trainloader'</strong>:<ul>
<li>'dataset': <ul>
<li>'type' (<em>str</em>): Type of dataset.</li>
<li>kwargs (<em>dict</em>) for dataset, such as 'root', 'split', etc.</li>
</ul>
</li>
<li>kwargs (<em>dict</em>) for DataLoader, such as 'batch_size', 'shuffle', etc.</li>
</ul>
</li>
<li><strong>'valloader'</strong>:<ul>
<li>'dataset': <ul>
<li>'type' (<em>str</em>): Type of dataset.</li>
<li>kwargs (<em>dict</em>) for dataset, such as 'root', 'split', etc.</li>
</ul>
</li>
<li>kwargs (<em>dict</em>) for DataLoader, such as 'batch_size', 'shuffle', etc.</li>
</ul>
</li>
<li><strong>'testloader'</strong>:<ul>
<li>'dataset':<ul>
<li>'type' (<em>str</em>): Type of dataset.</li>
<li>kwargs (<em>dict</em>) for dataset, such as 'root', 'split', etc.</li>
</ul>
</li>
<li>kwargs (<em>dict</em>) for DataLoader, such as 'batch_size', 'shuffle', etc.</li>
</ul>
</li>
<li><strong>'exp_name'</strong> (<em>str</em>): Experiment name.</li>
<li><strong>'work_dir'</strong> (<em>str</em>): Working directory to save logs and checkpoints.</li>
</ul>
</li>
<li><strong>session</strong> (<em>int</em>): Session number. If == 0, execute pre-training.
    If &gt; 0, execute incremental training.</li>
<li><strong>model</strong> (<em>nn.Module</em>): Model to be trained.</li>
<li><strong>train_loader</strong> (<em>DataLoader | dict, optional</em>): DataLoader for training.</li>
<li><strong>val_loader</strong> (<em>DataLoader | dict, optional</em>): DataLoader for validation.</li>
<li><strong>test_loader</strong> (<em>DataLoader | dict, optional</em>): DataLoader for testing.</li>
<li><strong>default_hooks</strong> (<em>dict, optional</em>): Default hooks to be registered.</li>
<li><strong>custom_hooks</strong> (<em>list, optional</em>): Custom hooks to be registered.</li>
<li><strong>load_from</strong> (<em>str, optional</em>): Checkpoint file path to load.</li>
<li><strong>work_dir</strong> (<em>str, optional</em>): Working directory to save logs and checkpoints.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong> train_step(self, batch, **kwargs)</strong></span></p>
<p>Training step. <strong>This method should be implemented in subclasses.</strong></p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>batch</strong> (<em>dict | tuple | list</em>): A batch of data from the data loader.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>
<p>results (dict): Contains the following:</p>
<p>{"key1": value1, "key2": value2,...}</p>
<p>keys denote the description of the value, such as <strong>"loss"</strong>, <strong>"acc"</strong>, <strong>"ccr"</strong>, etc.
values are the corresponding values of the keys, can be <em>int</em>, <em>float</em>, <em>str</em>, etc.    </p>
</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong> val_step(self, batch, </strong>kwargs)**</span></p>
<p>Validation step. <strong>This method should be implemented in subclasses.</strong></p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>batch</strong> (<em>dict | tuple | list</em>): A batch of data from the data loader.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>
<p>results (dict): Contains the following:</p>
<p>{"key1": value1, "key2": value2,...}</p>
<p>keys denote the description of the value, such as <strong>"loss"</strong>, <strong>"acc"</strong>, <strong>"ccr"</strong>, etc.
values are the corresponding values of the keys, can be <em>int</em>, <em>float</em>, <em>str</em>, etc.    </p>
</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong> test_step(self, batch, </strong>kwargs)**</span></p>
<p>Test step. <strong>This method should be implemented in subclasses.</strong></p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>batch</strong> (<em>dict | tuple | list</em>): A batch of data from the data loader.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>
<p>results (dict): Contains the following:</p>
<p>{"key1": value1, "key2": value2,...}</p>
<p>keys denote the description of the value, such as <strong>"loss"</strong>, <strong>"acc"</strong>, <strong>"ccr"</strong>, etc.
values are the corresponding values of the keys, can be <em>int</em>, <em>float</em>, <em>str</em>, etc.   </p>
</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong> train(self)</strong></span></p>
<p>Launch the training process.</p>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>model</strong> (<em>nn.Module</em>): Trained model.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong> val(self)</strong></span></p>
</li>
</ul>
<p>Validation process.</p>
<ul>
<li><span class="highlight-text"><strong> test(self)</strong></span></li>
</ul>
<p>Test process.</p>
<ul>
<li>
<p><span class="highlight-text"><strong> load_ckpt(self, fpath, device='cpu')</strong></span></p>
<p>Load checkpoint from file.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>fpath</strong> (<em>str</em>): Checkpoint file path.</li>
<li><strong>device</strong> (<em>str</em>): Device to load checkpoint. Defaults to 'cpu'.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>model</strong> (<em>nn.Module</em>): Loaded model.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong> save_ckpt(self, fpath)</strong></span></p>
<p>Save checkpoint to file.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>fpath</strong> (<em>str</em>): Checkpoint file path.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong> call_hook(self, fn_name: str, </strong>kwargs)**</span></p>
<p>Call all hooks with the specified function name.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><strong>fn_name</strong> (<em>str</em>): Function name to be called, such as:</p>
<ul>
<li><strong>'before_train_epoch'</strong></li>
<li><strong>'after_train_epoch'</strong></li>
<li><strong>'before_train_iter'</strong></li>
<li><strong>'after_train_iter'</strong></li>
<li><strong>'before_val_epoch'</strong></li>
<li><strong>'after_val_epoch'</strong></li>
<li><strong>'before_val_iter'</strong></li>
<li><strong>'after_val_iter'</strong></li>
</ul>
</li>
<li>
<p><strong>kwargs</strong> (<em>dict</em>): Arguments for the function.</p>
</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>register_hook(self, hook, priority=None)</strong></span></p>
<p><strong>Register a hook into the hook list.</strong></p>
<p>The hook will be inserted into a priority queue, with the specified priority (See :class:<code>Priority</code> for details of priorities). For hooks with the same priority, they will be triggered in the same order as they are registered. Priority of hook will be decided with the following priority:</p>
<ul>
<li><code>priority</code> argument. If <code>priority</code> is given, it will be priority of hook.</li>
<li>If <code>hook</code> argument is a dict and <code>priority</code> in it, the priority will be the value of <code>hook['priority']</code>.</li>
<li>If <code>hook</code> argument is a dict but <code>priority</code> not in it or <code>hook</code> is an instance of <code>hook</code>, the priority will be <code>hook.priority</code>.</li>
</ul>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>hook</strong> (<em>:obj:<code>Hook</code> or dict</em>): The hook to be registered. priority (int or str or :obj:<code>Priority</code>, optional): Hook priority. Lower value means higher priority.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong> register_default_hooks(self, hooks=None)</strong></span></p>
<p><strong>Register default hooks into hook list.</strong></p>
<p><code>hooks</code> will be registered into runner to execute some default actions like updating model parameters or saving checkpoints.</p>
<p>Default hooks and their priorities:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Hooks</th>
<th style="text-align: left;">Priority</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">RuntimeInfoHook</td>
<td style="text-align: left;">VERY_HIGH (10)</td>
</tr>
<tr>
<td style="text-align: left;">IterTimerHook</td>
<td style="text-align: left;">NORMAL (50)</td>
</tr>
<tr>
<td style="text-align: left;">DistSamplerSeedHook</td>
<td style="text-align: left;">NORMAL (50)</td>
</tr>
<tr>
<td style="text-align: left;">LoggerHook</td>
<td style="text-align: left;">BELOW_NORMAL (60)</td>
</tr>
<tr>
<td style="text-align: left;">ParamSchedulerHook</td>
<td style="text-align: left;">LOW (70)</td>
</tr>
<tr>
<td style="text-align: left;">CheckpointHook</td>
<td style="text-align: left;">VERY_LOW (90)</td>
</tr>
</tbody>
</table>
<p>If <code>hooks</code> is None, above hooks will be registered by default:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code>default_hooks = dict(
    logger=dict(type=&#39;LoggerHook&#39;),
    model=dict(type=&#39;ModelHook&#39;),
    alg=dict(type=&#39;AlgHook&#39;),
    optimizer = dict(type=&#39;OptimizerHook&#39;),
    scheduler = dict(type=&#39;SchedulerHook&#39;),
    metric = dict(type=&#39;MetricHook&#39;),
)
</code></pre></div></td></tr></table></div>
<p>If not None, <code>hooks</code> will be merged into <code>default_hooks</code>.
If there are None value in default_hooks, the corresponding item will
be popped from <code>default_hooks</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>hooks = dict(timer=None)
</code></pre></div></td></tr></table></div>
<p>The final registered default hooks will be :obj:<code>RuntimeInfoHook</code>, :obj:<code>DistSamplerSeedHook</code>, :obj:<code>LoggerHook</code>, :obj:<code>ParamSchedulerHook</code> and :obj:<code>CheckpointHook</code>.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>hooks</strong> (<em>dict[str, Hook or dict]</em>): Default hooks or configs to be registered.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong> register_custom_hooks(self, hooks)</strong></span></p>
<p>Register custom hooks into hook list.</p>
<p><strong>Parameters:</strong></p>
<p><strong>hooks</strong> (<em>list[Hook | dict]</em>): List of hooks or configs to be registered.</p>
</li>
<li>
<p><span class="highlight-text"><strong> register_hooks(self, default_hooks=None, custom_hooks=None)</strong></span></p>
<p>Register default hooks and custom hooks into hook list.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>default_hooks</strong> (<em>dict[str, dict] or dict[str, Hook]</em>): Hooks to execute default actions like updating model parameters and saving checkpoints.  Defaults to None.</li>
<li><strong>custom_hooks</strong> (<em>list[dict] or list[Hook]</em>): Hooks to execute custom actions like visualizing images processed by pipeline. Defaults to None.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>get_hooks_info(self)</strong></span></p>
<p>Get registered hooks information.</p>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>info</strong> (<em>str</em>): Information of registered hooks.</li>
</ul>
</li>
</ul>
<h3 id="ncdiatrainerspretrainerpy">ncdia.trainers.pretrainer.py<a class="headerlink" href="#ncdiatrainerspretrainerpy" title="Permanent link">&para;</a></h3>
<h4 id="pretrainer">PreTrainer<a class="headerlink" href="#pretrainer" title="Permanent link">&para;</a></h4>
<p>PreTrainer class for pre-training a model on session 0.</p>
<p><strong>Attributes:</strong></p>
<ul>
<li><strong>max_epochs</strong> (<em>int</em>): Total epochs for training.</li>
</ul>
<p><strong>Methods:</strong></p>
<ul>
<li><strong>__init__(self, max_epochs=1, **kwargs):</strong> The constructor method that initializes an instance of <strong>PreTrainer</strong>. <strong>max_epochs</strong> (<em>int</em>): Total epochs for training.</li>
<li><strong>train_step(self, batch, **kwargs):</strong> Training step.</li>
<li><strong>val_step(self, batch, **kwargs):</strong> Validation step.</li>
<li><strong>test_step(self, batch, **kwargs):</strong> Test step.</li>
<li>
<p><strong>batch_parser(batch)</strong> </p>
<p>Parse a batch of data.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>batch</strong> (<em>dict | tuple | list</em>): A batch of data.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>data</strong> (<em>torch.Tensor | list</em>): Input data.</li>
<li><strong>label</strong> (<em>torch.Tensor | list</em>): Label data.</li>
<li><strong>attribute</strong> (<em>torch.Tensor | list</em>): Attribute data.</li>
<li><strong>imgpath</strong> (<em>list of str</em>): Image path.</li>
</ul>
</li>
</ul>
<h3 id="ncdiatrainersinctrainerpy">ncdia.trainers.inctrainer.py<a class="headerlink" href="#ncdiatrainersinctrainerpy" title="Permanent link">&para;</a></h3>
<h4 id="inctrainer">IncTrainer<a class="headerlink" href="#inctrainer" title="Permanent link">&para;</a></h4>
<p>IncTrainer class for incremental training.</p>
<p><strong>Attributes:</strong></p>
<ul>
<li><strong>sess_cfg</strong> (<em>Configs</em>): Session configuration.</li>
<li><strong>num_sess</strong> (<em>int</em>): Number of sessions.</li>
<li><strong>session</strong> (<em>int</em>): Session number. If == 0, execute pre-training.
    If &gt; 0, execute incremental training.</li>
<li><strong>hist_trainset</strong> (<em>MergedDataset</em>): Historical training dataset.</li>
<li><strong>hist_valset</strong> (<em>MergedDataset</em>): Historical validation dataset.</li>
<li><strong>hist_testset</strong> (<em>MergedDataset</em>): Historical testing dataset.</li>
</ul>
<p><strong>Methods:</strong></p>
<ul>
<li>
<p><span class="highlight-text"><strong>  __init__(self, cfg=None, sess_cfg=None, ncd_cfg=None, session=0, model=None, hist_trainset=None, hist_testset=None, old_model=None, **kwargs)</strong></span></p>
<p>The constructor method that initializes an instance of <strong>IncTrainer</strong>. </p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>model</strong> (<em>nn.Module</em>): Model to be trained.</li>
<li><strong>cfg</strong> (<em>dict</em>): Configuration for trainer.</li>
<li><strong>sess_cfg</strong> (<em>Configs</em>): Session configuration.</li>
<li><strong>session</strong> (<em>int</em>): Session number. Default: 0.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong> train(self)</strong></span></p>
<p>Incremental training. </p>
<p><strong>self.num_sess</strong> determines the number of sessions, and session number is stored in <strong>self.session</strong>.</p>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>model</strong> (<em>nn.Module</em>): Trained model.</li>
</ul>
</li>
</ul>
<h3 id="ncdiatrainershooks">ncdia.trainers.hooks<a class="headerlink" href="#ncdiatrainershooks" title="Permanent link">&para;</a></h3>
<p>Implements some of the commonly used hooks.</p>
<h4 id="hook">Hook<a class="headerlink" href="#hook" title="Permanent link">&para;</a></h4>
<p><em>ncdia.trainers.hooks.hook.py</em></p>
<p>Base hook class. All hooks should inherit from this class.</p>
<h4 id="alghook">AlgHook<a class="headerlink" href="#alghook" title="Permanent link">&para;</a></h4>
<p><em>ncdia.trainers.hooks.alghook.py</em></p>
<p>A hook to modify algorithm state in the pipeline. This class is a base class for all algorithm hooks.</p>
<h4 id="loggerhook">LoggerHook<a class="headerlink" href="#loggerhook" title="Permanent link">&para;</a></h4>
<p><em>ncdia.trainers.hooks.loggerhook.py</em></p>
<p>A hook to log information during training and evaluation.</p>
<h4 id="metrichook">MetricHook<a class="headerlink" href="#metrichook" title="Permanent link">&para;</a></h4>
<p><em>ncdia.trainers.hooks.metrichook.py</em></p>
<p>A hook to calculate metrics during evaluation and testing.</p>
<h4 id="modelhook">ModelHook<a class="headerlink" href="#modelhook" title="Permanent link">&para;</a></h4>
<p><em>ncdia.trainers.hooks.modelhook.py</em></p>
<p>A hook to change model state in the pipeline, such as setting device, changing model to eval mode, etc.</p>
<h4 id="ncdhook">NCDHook<a class="headerlink" href="#ncdhook" title="Permanent link">&para;</a></h4>
<p><em>ncdia.trainers.hooks.ncdhook.py</em></p>
<p>A hook to execute OOD and NCD detection to relabel data</p>
<h4 id="optimizerhook">OptimizerHook<a class="headerlink" href="#optimizerhook" title="Permanent link">&para;</a></h4>
<p><em>ncdia.trainers.hooks.optimizerhook.py</em></p>
<p>A hook to put optimizer to zero_grad and step during training.</p>
<h4 id="schedulerhook">SchedulerHook<a class="headerlink" href="#schedulerhook" title="Permanent link">&para;</a></h4>
<p><em>ncdia.trainers.hooks.schedulerhook.py</em></p>
<p>A hook to change learning rate during training.</p>
<h3 id="ncdiatrainersoptims">ncdia.trainers.optims<a class="headerlink" href="#ncdiatrainersoptims" title="Permanent link">&para;</a></h3>
<h4 id="ncdiatrainersoptimsoptimizerpy">ncdia.trainers.optims.optimizer.py<a class="headerlink" href="#ncdiatrainersoptimsoptimizerpy" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><span class="highlight-text"><strong>build_optimizer(type, model, param_groups=None, **kwargs)</strong></span></p>
<p>Build optimizer.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>type</strong> (<em>str</em>): type of optimizer</li>
<li><strong>model</strong> (<em>nn.Module | dict</em>): model or param_groups</li>
<li><strong>param_groups</strong> (<em>dict | None</em>): 
    if provided, directly optimize param_groups and abandon model</li>
<li><strong>kwargs</strong> (<em>dict</em>): arguments for optimizer</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>optimizer</strong> (<em>torch.optim.Optimizer</em>): optimizer</li>
</ul>
</li>
</ul>
<h4 id="ncdiatrainersoptimsschedulerpy">ncdia.trainers.optims.scheduler.py<a class="headerlink" href="#ncdiatrainersoptimsschedulerpy" title="Permanent link">&para;</a></h4>
<p>Implements some of the commonly used scheduler.</p>
<ul>
<li><strong>CosineWarmupLR</strong></li>
<li><strong>LinearWarmupLR</strong></li>
<li><strong>ConstantLR</strong></li>
</ul>
<p><strong>Methods:</strong></p>
<ul>
<li>
<p><span class="highlight-text"><strong>build_scheduler(type, optimizer, **kwargs)</strong></span></p>
<p>Build learning rate scheduler.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>type</strong> (<em>str</em>): type of scheduler</li>
<li><strong>optimizer</strong> (t<em>orch.optim.Optimizer</em>): optimizer</li>
<li><strong>kwargs</strong> (<em>dict</em>): arguments for scheduler</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>lr_scheduler</strong> (<em>torch.optim.lr_scheduler._LRScheduler</em>): learning rate scheduler</li>
</ul>
</li>
</ul>
<h3 id="ncdiatrainerspriority">ncdia.trainers.priority<a class="headerlink" href="#ncdiatrainerspriority" title="Permanent link">&para;</a></h3>
<p>Hook priority levels.</p>
<h4 id="priority">Priority<a class="headerlink" href="#priority" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th style="text-align: left;">Level</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">HIGHEST</td>
<td style="text-align: left;">0</td>
</tr>
<tr>
<td style="text-align: left;">VERY_HIGH</td>
<td style="text-align: left;">10</td>
</tr>
<tr>
<td style="text-align: left;">HIGH</td>
<td style="text-align: left;">30</td>
</tr>
<tr>
<td style="text-align: left;">ABOVE_NORMAL</td>
<td style="text-align: left;">40</td>
</tr>
<tr>
<td style="text-align: left;">NORMAL</td>
<td style="text-align: left;">50</td>
</tr>
<tr>
<td style="text-align: left;">BELOW_NORMAL</td>
<td style="text-align: left;">60</td>
</tr>
<tr>
<td style="text-align: left;">LOW</td>
<td style="text-align: left;">70</td>
</tr>
<tr>
<td style="text-align: left;">VERY_LOW</td>
<td style="text-align: left;">90</td>
</tr>
<tr>
<td style="text-align: left;">LOWEST</td>
<td style="text-align: left;">100</td>
</tr>
</tbody>
</table>
<h2 id="ncdiautils">ncdia.utils<a class="headerlink" href="#ncdiautils" title="Permanent link">&para;</a></h2>
<h3 id="ncdiautilsmetrics">ncdia.utils.metrics<a class="headerlink" href="#ncdiautilsmetrics" title="Permanent link">&para;</a></h3>
<h4 id="ncdiautilsmetricsaccuracypy">ncdia.utils.metrics.accuracy.py<a class="headerlink" href="#ncdiautilsmetricsaccuracypy" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><span class="highlight-text"><strong>accuracy(output, target, topk=(1,))</strong></span></p>
<p>Computes the accuracy over the k-top predictions for the specified values of k.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>output</strong> (<em>torch.Tensor</em>): model output, shape (batch_size, num_classes)</li>
<li><strong>target</strong> (<em>torch.Tensor</em>): target labels, shape (batch_size)</li>
<li><strong>topk</strong> (<em>tuple</em>): top-k values, default is (1,)</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>acc</strong> (<em>list</em>): accuracy values for each k in topk</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>per_class_accuracy(output, target, topk=(1, ))</strong></span></p>
<p>Compute per class accuracy over the k-top predictions for the specified values of k </p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>output</strong> (<em>torch.Tensor</em>): model output, shape (batch_size, num_classes)</li>
<li><strong>target</strong> (<em>torch.Tensor</em>): target labels, shape (batch_size)</li>
<li><strong>topk</strong> (<em>tuple</em>): top-k values, default is (1,)</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>acc</strong> (<em>list</em>): accuracy values for each k in topk</li>
</ul>
</li>
</ul>
<h4 id="ncdiautilsmetricsmeterpy">ncdia.utils.metrics.meter.py<a class="headerlink" href="#ncdiautilsmetricsmeterpy" title="Permanent link">&para;</a></h4>
<p><strong>AverageMeter</strong></p>
<p>Computes and stores the average and current value.</p>
<h3 id="ncdiautilslosses">ncdia.utils.losses<a class="headerlink" href="#ncdiautilslosses" title="Permanent link">&para;</a></h3>
<h4 id="crossentropyloss">CrossEntropyLoss<a class="headerlink" href="#crossentropyloss" title="Permanent link">&para;</a></h4>
<p>In <em>crossentropy.py</em>. CrossEntropyLoss with label smoothing.</p>
<h4 id="angularpenaltysmloss">AngularPenaltySMLoss<a class="headerlink" href="#angularpenaltysmloss" title="Permanent link">&para;</a></h4>
<p>In <em>angular.py</em>. Angular Penalty Softmax Loss. Three 'loss_types' available: ['arcface', 'sphereface', 'cosface']</p>
<h3 id="ncdiautilscfgpy">ncdia.utils.cfg.py<a class="headerlink" href="#ncdiautilscfgpy" title="Permanent link">&para;</a></h3>
<h4 id="configs">Configs<a class="headerlink" href="#configs" title="Permanent link">&para;</a></h4>
<p>Include implementation of setup and use of configs.</p>
<h3 id="ncdiautilsloggerpy">ncdia.utils.logger.py<a class="headerlink" href="#ncdiautilsloggerpy" title="Permanent link">&para;</a></h3>
<p>Include implementation of loggers to write output to console and external text file.</p>
<h3 id="ncdiautilsregistrypy">ncdia.utils.registry.py<a class="headerlink" href="#ncdiautilsregistrypy" title="Permanent link">&para;</a></h3>
<h4 id="registry">Registry<a class="headerlink" href="#registry" title="Permanent link">&para;</a></h4>
<p>A registry to map strings to classes or functions.</p>
<p><strong>Examples:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code>&gt;&gt;&gt; REGISTRY = Registry()
&gt;&gt;&gt; @REGISTRY
&gt;&gt;&gt; def foo():
&gt;&gt;&gt;     return &#39;foo&#39;
&gt;&gt;&gt; @REGISTRY.register
&gt;&gt;&gt; def bar():
&gt;&gt;&gt;     return &#39;bar&#39;

&gt;&gt;&gt; print(REGISTRY[&#39;foo&#39;]())
foo
&gt;&gt;&gt; print(REGISTRY[&#39;bar&#39;]())
bar

&gt;&gt;&gt; print(REGISTRY)
{&#39;foo&#39;: &lt;function foo at 0x7f9b1c0e0d30&gt;, &#39;bar&#39;: &lt;function bar at 0x7f9b1c0e0e18&gt;}
&gt;&gt;&gt; print(REGISTRY[&#39;foo&#39;])
&lt;function foo at 0x7f9b1c0e0d30&gt;
&gt;&gt;&gt; print(REGISTRY[&#39;bar&#39;])
&lt;function bar at 0x7f9b1c0e0e18&gt;

&gt;&gt;&gt; print(&#39;foo&#39; in REGISTRY)
True
&gt;&gt;&gt; print(&#39;bar&#39; in REGISTRY)
True
&gt;&gt;&gt; print(&#39;foobar&#39; in REGISTRY)
False

&gt;&gt;&gt; print(REGISTRY.keys())
dict_keys([&#39;foo&#39;, &#39;bar&#39;])
&gt;&gt;&gt; print(REGISTRY.values())
dict_values([&lt;function foo at 0x7f9b1c0e0d30&gt;, &lt;function bar at 0x7f9b1c0e0e18&gt;])
&gt;&gt;&gt; print(REGISTRY.items())
dict_items([(&#39;foo&#39;, &lt;function foo at 0x7f9b1c0e0d30&gt;), (&#39;bar&#39;, &lt;function bar at 0x7f9b1c0e0e18&gt;)])
&gt;&gt;&gt; print(len(REGISTRY))
2
</code></pre></div></td></tr></table></div>
<ul>
<li>
<p><span class="highlight-text"><strong>register_callable(self, target: callable)</strong></span></p>
<p>Register a target.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>target</strong> (<em>callable</em>): callable target to be registered.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>register_dict(self, target)</strong></span></p>
<p>Register a dict.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>target</strong> (<em>dict</em>): A dict to be registered. All its values should be callable.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>register(self, target)</strong></span></p>
<p>Register a target.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>target</strong> (<em>callable | dict</em>): target to be registered.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>target</strong> (<em>object</em>): Registered target.</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>build(self, target: dict | Configs, **kwargs)</strong></span></p>
<p>Build a target with configs.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>target</strong> (<em>dict | Configs</em>): A dict to be built. It should have a key 'type' to specify the target type. It may have other keys to specify the target configs.</li>
<li><strong>kwargs</strong> (<em>dict</em>): Additional keyword arguments.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><strong>target</strong> (<em>object</em>): A built target.</li>
</ul>
</li>
</ul>
<h3 id="ncdiautilstoolspy">ncdia.utils.tools.py<a class="headerlink" href="#ncdiautilstoolspy" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><span class="highlight-text"><strong>mkdir_if_missing(dirname)</strong></span></p>
<p>Create dirname if it is missing.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>dirname</strong> (<em>str</em>): directory path</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>auto_device(device)</strong></span></p>
<p>Automatically set the device for the input tensor.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>device</strong> (<em>str | torch.device | None</em>): device name or device object. If None, return torch.device('cuda') if available, otherwise return torch.device('cpu').</li>
</ul>
</li>
<li>
<p><span class="highlight-text"><strong>set_random_seed(seed)</strong></span></p>
<p>Set random seed for reproducibility.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>seed</strong> (<em>int</em>): random seed</li>
</ul>
</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 <a href="https://github.com/HAIV-Lab" target="_blank">HAIV Lab</a>. Licensed under the <a href="https://opensource.org/licenses/MIT" target="_blank">MIT License</a>.
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/HAIV-Lab" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://haivlab.wixsite.com/home" target="_blank" rel="noopener" title="haivlab.wixsite.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<xex@hust.edu.cn>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://space.bilibili.com/1716209957?spm_id_from=333.337.0.0" target="_blank" rel="noopener" title="space.bilibili.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M488.6 104.1c16.7 18.1 24.4 39.7 23.3 65.7v202.4c-.4 26.4-9.2 48.1-26.5 65.1-17.2 17-39.1 25.9-65.5 26.7H92c-26.4-.8-48.2-9.8-65.3-27.2S.7 396.5 0 368.2V169.8c.8-26 9.7-47.6 26.7-65.7C43.8 87.8 65.5 78.8 92 78h29.4L96 52.2c-5.7-5.7-8.6-13-8.6-21.8S90.3 14.3 96 8.6 109 0 117.9 0s16.1 2.9 21.9 8.6L213.1 78h88l74.5-69.4C381.7 2.9 389.2 0 398 0s16.1 2.9 21.9 8.6c5.7 5.7 8.6 13 8.6 21.8s-2.9 16.1-8.6 21.8L394.6 78h29.3c26.4.8 48 9.8 64.7 26.1m-38.8 69.7c-.4-9.6-3.7-17.4-10.7-23.5-5.2-6.1-14-9.4-22.7-9.8H96c-9.6.4-17.4 3.7-23.6 9.8-6.1 6.1-9.4 13.9-9.8 23.5v194.4c0 9.2 3.3 17 9.8 23.5s14.4 9.8 23.6 9.8h320.4c9.2 0 17-3.3 23.3-9.8s9.7-14.3 10.1-23.5zm-264.3 42.7c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.2 6.3-14 9.5-23.6 9.5s-17.5-3.2-23.6-9.5-9.4-14-9.8-23.2v-33.3c.4-9.1 3.8-16.9 10.1-23.2s13.2-9.6 23.3-10c9.2.4 17 3.7 23.3 10m191.5 0c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2s-14 9.5-23.6 9.5-17.4-3.2-23.6-9.5c-7-6.3-9.4-14-9.7-23.2v-33.3c.3-9.1 3.7-16.9 10-23.2s14.1-9.6 23.3-10c9.2.4 17 3.7 23.3 10"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../javascripts/extra.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>